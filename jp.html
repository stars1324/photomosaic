<!DOCTYPE html>
<html lang="ja" id="html-root">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO優化 - TDK -->
    <title>フォトモザイクツール - オンラインモザイクジェネレーター | 無料写真モザイク作成</title>
    <meta name="description" content="プロフェッショナルなオンラインフォトモザイクツール。複数の背景画像をアップロードして芸術的なモザイク効果を作成。無料で使用でき、インストール不要、高品質出力で個人および商用デザインに対応。">
    <meta name="keywords" content="フォトモザイク,モザイクジェネレーター,写真コラージュ,画像モザイク,オンラインデザインツール,芸術効果,無料ツール,画像処理">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="フォトモザイクツール - オンラインモザイクジェネレーター">
    <meta property="og:description" content="プロフェッショナルなオンラインフォトモザイクツール。複数の背景画像をアップロードして芸術的なモザイク効果を作成。無料で使用でき、インストール不要。">
    <meta property="og:image" content="/og-image.jpg">
    <meta property="og:url" content="https://yourdomain.com/jp.html">
    <meta property="og:site_name" content="フォトモザイクツール">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="フォトモザイクツール - オンラインモザイクジェネレーター">
    <meta name="twitter:description" content="プロフェッショナルなオンラインフォトモザイクツール。複数の背景画像をアップロードして芸術的なモザイク効果を作成。">
    <meta name="twitter:image" content="/twitter-image.jpg">

    <!-- その他SEO metaタグ -->
    <meta name="author" content="フォトモザイクツール">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    <meta name="language" content="ja">
    <meta name="revisit-after" content="7 days">
    <meta name="theme-color" content="#2563eb">

    <!-- 構造化データ - JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "フォトモザイクツール",
        "description": "プロフェッショナルなオンラインフォトモザイクツール。複数の背景画像をアップロードして芸術的なモザイク効果を作成",
        "url": "https://yourdomain.com/jp.html",
        "applicationCategory": "DesignApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "JPY"
        },
        "featureList": [
            "オンラインモザイク生成",
            "複数画像形式対応",
            "高品質出力",
            "無料使用",
            "登録不要"
        ]
    }
    </script>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- 言語代替リンク -->
    <link rel="alternate" hreflang="zh" href="index.html">
    <link rel="alternate" hreflang="en" href="en.html">
    <link rel="alternate" hreflang="ja" href="jp.html">
    <link rel="alternate" hreflang="ko" href="kr.html">

    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>フォトモザイクツール</h1>
            <p>ターゲット画像と背景画像ライブラリをアップロードして、芸術的なモザイク効果を作成</p>

            <!-- 言語リンク -->
            <div class="language-links">
                <a href="index.html" class="language-link" title="中国語に切り替え">
                    <span class="language-flag">🇨🇳</span>
                    <span class="language-name">中文</span>
                </a>
                <a href="en.html" class="language-link" title="英語に切り替え">
                    <span class="language-flag">🇺🇸</span>
                    <span class="language-name">English</span>
                </a>
                <a href="jp.html" class="language-link active" title="日本語に切り替え">
                    <span class="language-flag">🇯🇵</span>
                    <span class="language-name">日本語</span>
                </a>
                <a href="kr.html" class="language-link" title="韓国語に切り替え">
                    <span class="language-flag">🇰🇷</span>
                    <span class="language-name">한국어</span>
                </a>
            </div>
        </header>

        <!-- 簡単な使用方法 -->
        <section style="background:#f8f9fa;border-radius:8px;padding:16px 20px;margin-bottom:24px;box-shadow:0 2px 8px rgba(0,0,0,0.04);">
            <h2 style="font-size:1.2rem;color:#333;margin-bottom:10px;">使用方法</h2>
            <ol style="color:#555;font-size:1rem;line-height:1.8;padding-left:20px;">
                <li>複数の背景画像またはZIPファイルを「背景画像ライブラリ」セクションにアップロードします。</li>
                <li>ターゲット画像を「ターゲット画像」セクションにアップロードします。</li>
                <li>グリッド精度、出力品質、背景画像の再利用設定を調整します。</li>
                <li>「モザイク生成」ボタンをクリックして完了を待ちます。</li>
                <li>下部で結果をプレビューし、PNG/JPG形式でダウンロードします。</li>
            </ol>
        </section>

        <main role="main" id="main-content">
            <!-- アップロードセクション -->
            <section class="upload-section" aria-labelledby="upload-heading">
                <h2 id="upload-heading" class="sr-only">画像アップロード領域</h2>
                <div class="upload-container">
                    <!-- 背景画像アップロード -->
                    <article class="upload-area" id="bg-upload-area">
                        <h3>背景画像ライブラリ</h3>
                        <div class="drop-zone" id="bg-drop-zone" role="button" tabindex="0" aria-label="背景画像をドラッグまたはクリックしてアップロード">
                            <div class="drop-content">
                                <svg class="upload-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
                                </svg>
                                <p>複数の画像またはZIPファイルをここにドラッグ、JPG、PNG、WebP形式をサポート</p>
                                <button type="button" class="upload-btn" id="bg-upload-btn" aria-describedby="bg-upload-help">ファイルを選択</button>
                                <input type="file" id="bg-file-input" multiple accept="image/*,.zip" style="display: none;" aria-label="背景画像ファイルを選択">
                            </div>
                        </div>
                        <div class="upload-info">
                            <span id="bg-count" aria-live="polite">アップロード済み: 0 枚の画像</span>
                            <button type="button" class="clear-btn" id="clear-bg-btn" aria-label="すべての背景画像をクリア">ライブラリをクリア</button>
                        </div>
                        <small id="bg-upload-help">最高のモザイク効果を得るために、50-200枚の異なる高品質画像のアップロードを推奨</small>
                    </article>

                    <!-- ターゲット画像アップロード -->
                    <article class="upload-area" id="target-upload-area">
                        <h3>ターゲット画像アップロード</h3>
                        <div class="drop-zone" id="target-drop-zone" role="button" tabindex="0" aria-label="ターゲット画像をドラッグまたはクリックしてアップロード">
                            <div class="drop-content" id="target-drop-content">
                                <svg class="upload-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z" />
                                </svg>
                                <p>ターゲット画像をここにドラッグしてモザイク作品に変換</p>
                                <button type="button" class="upload-btn" id="target-upload-btn" aria-describedby="target-upload-help">画像を選択</button>
                                <input type="file" id="target-file-input" accept="image/*" style="display: none;" aria-label="ターゲット画像ファイルを選択">
                            </div>
                            <div class="target-preview" id="target-preview" style="display: none;">
                                <img id="target-img" alt="ターゲット画像プレビュー" loading="lazy">
                                <button type="button" class="remove-btn" id="remove-target-btn" aria-label="ターゲット画像を削除">削除</button>
                            </div>
                        </div>
                        <small id="target-upload-help">JPG、PNG、WebP形式をサポート。高解像度画像を推奨</small>
                    </article>
                </div>
            </section>

            <!-- 設定セクション -->
            <section class="config-section" aria-labelledby="config-heading">
                <h3 id="config-heading">モザイク生成パラメータ</h3>
                <div class="config-container">
                    <div class="config-item">
                        <label for="grid-size">グリッド精度（グリッド数）:</label>
                        <div class="slider-container">
                            <input type="range" id="grid-size" min="20" max="200" value="50" step="1" aria-describedby="grid-size-help">
                            <span id="grid-value" aria-live="polite">50</span>
                        </div>
                        <small id="grid-size-help">値が大きいほど詳細なモザイクになりますが、生成時間が長くなります。推奨値：50-100</small>
                    </div>
                    <div class="config-item">
                        <label for="output-quality">出力品質:</label>
                        <select id="output-quality" aria-describedby="quality-help">
                            <option value="standard">標準品質（ウェブプレビューとソーシャル共有に適している）</option>
                            <option value="high" selected>高品質（印刷とプロ用途に適している）</option>
                            <option value="ultra">超高品質（大判印刷に適している）</option>
                        </select>
                        <small id="quality-help">品質が高いほど解像度とファイルサイズが大きくなります</small>
                    </div>
                    <div class="config-item">
                        <label for="allow-reuse">
                            <input type="checkbox" id="allow-reuse" checked aria-describedby="reuse-help">
                            背景画像の再利用を許可
                        </label>
                        <small id="reuse-help">再利用を許可するとマッチング精度が向上しますが、視覚的多様性が減る可能性があります</small>
                    </div>
                </div>
            </section>

            <!-- アクションセクション -->
            <section class="action-section" aria-labelledby="action-heading">
                <h3 id="action-heading" class="sr-only">アクション制御</h3>
                <button type="button" class="primary-btn" id="generate-btn" disabled aria-describedby="generate-help">モザイク生成</button>
                <button type="button" class="secondary-btn" id="reset-btn" aria-label="すべての設定とアップロードした画像をリセット">リセット</button>
                <small id="generate-help">最初に背景ライブラリとターゲット画像をアップロードしてください</small>
            </section>

            <!-- プログレスセクション -->
            <section class="progress-section" id="progress-section" style="display: none;" aria-labelledby="progress-heading">
                <h3 id="progress-heading">生成進行状況</h3>
                <div class="progress-container">
                    <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text" id="progress-text" aria-live="polite">準備中...</div>
                </div>
            </section>

            <!-- 結果セクション -->
            <section class="result-section" id="result-section" style="display: none;" aria-labelledby="result-heading">
                <h3 id="result-heading">モザイク生成結果</h3>
                <div class="result-container">
                    <div class="canvas-container">
                        <canvas id="result-canvas" aria-label="生成されたモザイク画像"></canvas>
                    </div>
                    <div class="result-controls">
                        <button type="button" class="download-btn" id="download-png-btn" aria-label="PNG形式のモザイク画像をダウンロード">PNG ダウンロード</button>
                        <button type="button" class="download-btn" id="download-jpg-btn" aria-label="JPG形式のモザイク画像をダウンロード">JPG ダウンロード</button>
                    </div>
                    <p class="result-description">モザイク作品が完成しました！右クリックで保存するか、ダウンロードボタンで高品質画像を取得してください。</p>
                </div>
            </section>
        </main>

        <!-- フッター -->
        <footer role="contentinfo">
            <div class="footer-content">
                <p>&copy; 2025 フォトモザイクツール - プロフェッショナルオンラインモザイクジェネレーター</p>
                <p>無料使用 • 登録不要 • 複数形式対応 • 高品質出力</p>
                <nav class="footer-nav" aria-label="フッターナビゲーション">
                    <a href="#" rel="noopener">チュートリアル</a>
                    <a href="#" rel="noopener">FAQ</a>
                    <a href="#" rel="noopener">お問い合わせ</a>
                    <a href="#" rel="noopener">プライバシーポリシー</a>
                </nav>
            </div>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="photomosaic.js"></script>
    <script src="app.js"></script>
</body>
</html>

