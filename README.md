# 千图成像工具 (Photomosaic Tool)

一个纯前端实现的千图成像工具，可以将目标图片转换为由大量小图片组成的马赛克效果图。

## 功能特点

- 🖼️ **纯前端实现**: 所有处理均在浏览器端完成，无需服务器
- 📁 **多种上传方式**: 支持单张/多张图片上传，也支持ZIP压缩包批量上传
- ⚙️ **可调参数**: 可调整网格精度和背景图复用设置
- 🎨 **智能匹配**: 基于颜色相似度的最佳匹配算法
- 💾 **多格式下载**: 支持PNG和JPG格式下载
- 📱 **响应式设计**: 适配不同尺寸的设备屏幕

## 使用方法

### 1. 打开应用
在浏览器中打开 `index.html` 文件即可开始使用。

### 2. 上传背景图片库
- 点击"背景图片库"区域的"选择文件"按钮，或直接拖拽文件到该区域
- 支持以下方式：
  - 一次选择多张图片文件
  - 上传包含图片的ZIP压缩包
- 支持的图片格式：JPG、PNG、GIF、BMP、WebP

### 3. 上传目标图片
- 点击"目标图片"区域的"选择图片"按钮，或直接拖拽图片到该区域
- 上传一张你想要转换为马赛克效果的图片

### 4. 调整参数
- **分割精度**: 调整滑动条设置网格数量（20-200），数值越大细节越丰富但生成时间越长
- **背景图复用**: 选择是否允许重复使用同一张背景图片

### 5. 生成马赛克
- 点击"开始生成"按钮开始处理
- 等待进度条完成，过程中会显示实时状态

### 6. 下载结果
- 生成完成后，可以选择下载PNG或JPG格式的结果图片

## 技术实现

### 核心技术
- **HTML5 Canvas**: 用于图像处理和渲染
- **File API**: 处理文件上传和读取
- **JSZip**: 处理ZIP文件解压
- **Web API**: 纯JavaScript实现，无外部依赖

### 算法原理
1. **特征提取**: 计算每张背景图片的平均RGB颜色值
2. **网格分割**: 将目标图片按设定精度分割为N×N网格
3. **颜色匹配**: 使用欧氏距离算法找到每个网格的最佳匹配背景图
4. **图像合成**: 将匹配的背景图片按比例绘制到对应网格位置

### 性能优化
- 背景图片预处理和缓存
- 分批处理避免UI阻塞
- 内存管理和资源释放
- 响应式布局适配

## 浏览器兼容性

支持所有现代浏览器：
- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

## 注意事项

- 处理速度和可处理的图片数量取决于设备性能
- 建议背景图片数量在100-1000张之间以获得最佳效果
- 网格精度过高可能导致处理时间较长
- 大量图片处理时请确保设备有足够的内存

## 项目结构

```
├── index.html          # 主页面
├── styles.css          # 样式文件
├── app.js             # 主应用逻辑
├── photomosaic.js     # 核心处理算法
├── bg/                # 示例背景图片文件夹
└── README.md          # 说明文档
```

## 开发说明

如需修改或扩展功能，主要文件说明：

- `photomosaic.js`: 包含 `PhotoMosaicProcessor` 类，负责核心图像处理算法
- `app.js`: 包含 `PhotoMosaicApp` 类，负责UI交互和流程控制
- `styles.css`: 包含所有样式定义，采用响应式设计
- `index.html`: 主页面结构，引入必要的依赖

## 许可证

本项目采用 MIT 许可证。
